function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function e(t,r){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,r)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=navigator.userAgent,i=document.referrer,a=function(){return(new Date).getTime()},s=function(){return(""+a()*Math.random()).slice(0,8)},u=function(){return~~performance.now()},c=function(t){window.dispatchEvent(new CustomEvent(t,{detail:{target:this,time:a()}}))},f=function(t){return"function"==typeof t},l=function(t){return t<400},h=function t(e){if(""!==e.id)return'//*[@id="'+e.id+'"]';if(e==document.body)return"/html/"+e.tagName.toLowerCase();for(var r=1,n=e.parentNode.childNodes,o=0,i=n.length;o<i;o++){var a=n[o];if(a==e)return t(e.parentNode)+"/"+e.tagName.toLowerCase()+"["+r+"]";1==a.nodeType&&a.tagName==e.tagName&&r++}},d=function(t,e){void 0===e&&(e=200);var r="string"==typeof t?t:JSON.stringify(t);if(r&&r.length>e){var n=Math.max(e-100,50);r=r.substr(0,n)+"... ..."+r.substr(n-e+50)}return r||""},p=function(t){return t.replace(/^[^/]*:?\/\//,"").split(/\?|#/)[0]},m=function(t,e){return t.some((function(t){return t instanceof RegExp?t.test(e):"string"==typeof t?p(t)===p(e):void 0}))};var v=function(){var t=navigator.userAgent.toLowerCase();return(t.indexOf("msie")>-1?t.match(/msie ([\d.]+)/)[1]:100)<=8},g=function(t){return t?t===document?"html":t.tagName?t.tagName:t.outerHTML.match(/<([^>\s]+)/)[1]:""},y=function(t){var e,r=t.error||{};return{type:t._type||t.type,name:null==(e=t.name||t.message&&t.message.split(":")[0]||t.type)?void 0:e.replace(/^Uncaught\s/,""),message:d(t.message||t.description||"",300),extraInfo:t.extraInfo||{},stacktrace:t.error&&r.stack,target:t._target,timeStamp:u(),title:document.title,referrer:i,url:location.href,userAgent:o,columnNumber:t.colno||r.columnNumber,lineNumber:t.lineno||r.lineNumber,cookie:document.cookie,version:"1.0.0"}},w=Uint8Array,b=Uint16Array,E=Uint32Array,S=new w([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),k=new w([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),x=new w([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),T=function(t,e){for(var r=new b(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];var o=new E(r[30]);for(n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)o[i]=i-r[n]<<5|n;return[r,o]},C=T(S,2),j=C[0],_=C[1];j[28]=258,_[258]=28;for(var P=T(k,0)[1],L=new b(32768),N=0;N<32768;++N){var M=(43690&N)>>>1|(21845&N)<<1;M=(61680&(M=(52428&M)>>>2|(13107&M)<<2))>>>4|(3855&M)<<4,L[N]=((65280&M)>>>8|(255&M)<<8)>>>1}var A=function(t,e,r){for(var n=t.length,o=0,i=new b(e);o<n;++o)++i[t[o]-1];var a,s=new b(e);for(o=0;o<e;++o)s[o]=s[o-1]+i[o-1]<<1;if(r){a=new b(1<<e);var u=15-e;for(o=0;o<n;++o)if(t[o])for(var c=o<<4|t[o],f=e-t[o],l=s[t[o]-1]++<<f,h=l|(1<<f)-1;l<=h;++l)a[L[l]>>>u]=c}else for(a=new b(n),o=0;o<n;++o)t[o]&&(a[o]=L[s[t[o]-1]++]>>>15-t[o]);return a},O=new w(288);for(N=0;N<144;++N)O[N]=8;for(N=144;N<256;++N)O[N]=9;for(N=256;N<280;++N)O[N]=7;for(N=280;N<288;++N)O[N]=8;var I=new w(32);for(N=0;N<32;++N)I[N]=5;var R=A(O,9,0),$=A(I,5,0),H=function(t){return(t+7)/8|0},U=function(t,e,r){(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length);var n=new(t instanceof b?b:t instanceof E?E:w)(r-e);return n.set(t.subarray(e,r)),n},W=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],D=function(t,e,r){var n=new Error(e||W[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,D),!r)throw n;return n},B=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8},K=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8,t[n+2]|=r>>>16},q=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var o=r.length,i=r.slice();if(!o)return[V,0];if(1==o){var a=new w(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var s=r[0],u=r[1],c=0,f=1,l=2;for(r[0]={s:-1,f:s.f+u.f,l:s,r:u};f!=o-1;)s=r[r[c].f<r[l].f?c++:l++],u=r[c!=f&&r[c].f<r[l].f?c++:l++],r[f++]={s:-1,f:s.f+u.f,l:s,r:u};var h=i[0].s;for(n=1;n<o;++n)i[n].s>h&&(h=i[n].s);var d=new b(h+1),p=J(r[f-1],d,0);if(p>e){n=0;var m=0,v=p-e,g=1<<v;for(i.sort((function(t,e){return d[e.s]-d[t.s]||t.f-e.f}));n<o;++n){var y=i[n].s;if(!(d[y]>e))break;m+=g-(1<<p-d[y]),d[y]=e}for(m>>>=v;m>0;){var E=i[n].s;d[E]<e?m-=1<<e-d[E]++-1:++n}for(;n>=0&&m;--n){var S=i[n].s;d[S]==e&&(--d[S],++m)}p=e}return[new w(d),p]},J=function(t,e,r){return-1==t.s?Math.max(J(t.l,e,r+1),J(t.r,e,r+1)):e[t.s]=r},F=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new b(++e),n=0,o=t[0],i=1,a=function(t){r[n++]=t},s=1;s<=e;++s)if(t[s]==o&&s!=e)++i;else{if(!o&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(o),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(o);i=1,o=t[s]}return[r.subarray(0,n),e]},G=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},X=function(t,e,r){var n=r.length,o=H(e+2);t[o]=255&n,t[o+1]=n>>>8,t[o+2]=255^t[o],t[o+3]=255^t[o+1];for(var i=0;i<n;++i)t[o+i+4]=r[i];return 8*(o+4+n)},z=function(t,e,r,n,o,i,a,s,u,c,f){B(e,f++,r),++o[256];for(var l=q(o,15),h=l[0],d=l[1],p=q(i,15),m=p[0],v=p[1],g=F(h),y=g[0],w=g[1],E=F(m),T=E[0],C=E[1],j=new b(19),_=0;_<y.length;++_)j[31&y[_]]++;for(_=0;_<T.length;++_)j[31&T[_]]++;for(var P=q(j,7),L=P[0],N=P[1],M=19;M>4&&!L[x[M-1]];--M);var H,U,W,D,J=c+5<<3,z=G(o,O)+G(i,I)+a,Q=G(o,h)+G(i,m)+a+14+3*M+G(j,L)+(2*j[16]+3*j[17]+7*j[18]);if(J<=z&&J<=Q)return X(e,f,t.subarray(u,u+c));if(B(e,f,1+(Q<z)),f+=2,Q<z){H=A(h,d,0),U=h,W=A(m,v,0),D=m;var V=A(L,N,0);B(e,f,w-257),B(e,f+5,C-1),B(e,f+10,M-4),f+=14;for(_=0;_<M;++_)B(e,f+3*_,L[x[_]]);f+=3*M;for(var Y=[y,T],Z=0;Z<2;++Z){var tt=Y[Z];for(_=0;_<tt.length;++_){var et=31&tt[_];B(e,f,V[et]),f+=L[et],et>15&&(B(e,f,tt[_]>>>5&127),f+=tt[_]>>>12)}}}else H=R,U=O,W=$,D=I;for(_=0;_<s;++_)if(n[_]>255){et=n[_]>>>18&31;K(e,f,H[et+257]),f+=U[et+257],et>7&&(B(e,f,n[_]>>>23&31),f+=S[et]);var rt=31&n[_];K(e,f,W[rt]),f+=D[rt],rt>3&&(K(e,f,n[_]>>>5&8191),f+=k[rt])}else K(e,f,H[n[_]]),f+=U[n[_]];return K(e,f,H[256]),f+U[256]},Q=new E([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V=new w(0),Y=function(t,e,r,n,o){return function(t,e,r,n,o,i){var a=t.length,s=new w(n+a+5*(1+Math.ceil(a/7e3))+o),u=s.subarray(n,s.length-o),c=0;if(!e||a<8)for(var f=0;f<=a;f+=65535){var l=f+65535;l<a?c=X(u,c,t.subarray(f,l)):(u[f]=i,c=X(u,c,t.subarray(f,a)))}else{for(var h=Q[e-1],d=h>>>13,p=8191&h,m=(1<<r)-1,v=new b(32768),g=new b(m+1),y=Math.ceil(r/3),x=2*y,T=function(e){return(t[e]^t[e+1]<<y^t[e+2]<<x)&m},C=new E(25e3),j=new b(288),L=new b(32),N=0,M=0,A=(f=0,0),O=0,I=0;f<a;++f){var R=T(f),$=32767&f,W=g[R];if(v[$]=W,g[R]=$,O<=f){var D=a-f;if((N>7e3||A>24576)&&D>423){c=z(t,u,0,C,j,L,M,A,I,f-I,c),A=N=M=0,I=f;for(var B=0;B<286;++B)j[B]=0;for(B=0;B<30;++B)L[B]=0}var K=2,q=0,J=p,F=$-W&32767;if(D>2&&R==T(f-F))for(var G=Math.min(d,D)-1,Y=Math.min(32767,f),Z=Math.min(258,D);F<=Y&&--J&&$!=W;){if(t[f+K]==t[f+K-F]){for(var tt=0;tt<Z&&t[f+tt]==t[f+tt-F];++tt);if(tt>K){if(K=tt,q=F,tt>G)break;var et=Math.min(F,tt-2),rt=0;for(B=0;B<et;++B){var nt=f-F+B+32768&32767,ot=nt-v[nt]+32768&32767;ot>rt&&(rt=ot,W=nt)}}}F+=($=W)-(W=v[$])+32768&32767}if(q){C[A++]=268435456|_[K]<<18|P[q];var it=31&_[K],at=31&P[q];M+=S[it]+k[at],++j[257+it],++L[at],O=f+K,++N}else C[A++]=t[f],++j[t[f]]}}c=z(t,u,i,C,j,L,M,A,I,f-I,c),!i&&7&c&&(c=X(u,c+1,V))}return U(s,0,n+H(c)+o)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,r,n,!o)};function Z(t,e){e||(e={});var r=function(){var t=1,e=0;return{p:function(r){for(var n=t,o=e,i=0|r.length,a=0;a!=i;){for(var s=Math.min(a+2655,i);a<s;++a)o+=n+=r[a];n=(65535&n)+15*(n>>16),o=(65535&o)+15*(o>>16)}t=n,e=o},d:function(){return(255&(t%=65521))<<24|t>>>8<<16|(255&(e%=65521))<<8|e>>>8}}}();r.p(t);var n=Y(t,e,2,4);return function(t,e){var r=e.level,n=0==r?0:r<6?1:9==r?3:2;t[0]=120,t[1]=n<<6|(n?32-2*n:1)}(n,e),function(t,e,r){for(;r;++e)t[e]=r,r>>>=8}(n,n.length-4,r.d()),n}var tt="undefined"!=typeof TextEncoder&&new TextEncoder,et="undefined"!=typeof TextDecoder&&new TextDecoder;try{et.decode(V,{stream:!0}),1}catch(t){}function rt(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}if(et)return et.decode(t);var o=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,U(t,r-1)];o?3==o?(n=((15&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536,e+=String.fromCharCode(55296|n>>10,56320|1023&n)):e+=1&o?String.fromCharCode((31&n)<<6|63&t[r++]):String.fromCharCode((15&n)<<12|(63&t[r++])<<6|63&t[r++]):e+=String.fromCharCode(n)}}(t),i=o[0];return o[1].length&&D(8),i}function nt(t){return rt(Z(function(t,e){if(e){for(var r=new w(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}if(tt)return tt.encode(t);var o=t.length,i=new w(t.length+(t.length>>1)),a=0,s=function(t){i[a++]=t};for(n=0;n<o;++n){if(a+5>i.length){var u=new w(a+8+(o-n<<1));u.set(i),i=u}var c=t.charCodeAt(n);c<128||e?s(c):c<2048?(s(192|c>>6),s(128|63&c)):c>55295&&c<57344?(s(240|(c=65536+(1047552&c)|1023&t.charCodeAt(++n))>>18),s(128|c>>12&63),s(128|c>>6&63),s(128|63&c)):(s(224|c>>12),s(128|c>>6&63),s(128|63&c))}return U(i,0,a)}(t="string"==typeof t?t:JSON.stringify(t))),!0)}var ot="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var it=function(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}((function(t){!function(e){function r(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function n(t,e,n,o,i,a){return r((s=r(r(e,t),r(o,a)))<<(u=i)|s>>>32-u,n);var s,u}function o(t,e,r,o,i,a,s){return n(e&r|~e&o,t,e,i,a,s)}function i(t,e,r,o,i,a,s){return n(e&o|r&~o,t,e,i,a,s)}function a(t,e,r,o,i,a,s){return n(e^r^o,t,e,i,a,s)}function s(t,e,r,o,i,a,s){return n(r^(e|~o),t,e,i,a,s)}function u(t,e){var n,u,c,f;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var l=1732584193,h=-271733879,d=-1732584194,p=271733878,m=0;m<t.length;m+=16)l=o(n=l,u=h,c=d,f=p,t[m],7,-680876936),p=o(p,l,h,d,t[m+1],12,-389564586),d=o(d,p,l,h,t[m+2],17,606105819),h=o(h,d,p,l,t[m+3],22,-1044525330),l=o(l,h,d,p,t[m+4],7,-176418897),p=o(p,l,h,d,t[m+5],12,1200080426),d=o(d,p,l,h,t[m+6],17,-1473231341),h=o(h,d,p,l,t[m+7],22,-45705983),l=o(l,h,d,p,t[m+8],7,1770035416),p=o(p,l,h,d,t[m+9],12,-1958414417),d=o(d,p,l,h,t[m+10],17,-42063),h=o(h,d,p,l,t[m+11],22,-1990404162),l=o(l,h,d,p,t[m+12],7,1804603682),p=o(p,l,h,d,t[m+13],12,-40341101),d=o(d,p,l,h,t[m+14],17,-1502002290),l=i(l,h=o(h,d,p,l,t[m+15],22,1236535329),d,p,t[m+1],5,-165796510),p=i(p,l,h,d,t[m+6],9,-1069501632),d=i(d,p,l,h,t[m+11],14,643717713),h=i(h,d,p,l,t[m],20,-373897302),l=i(l,h,d,p,t[m+5],5,-701558691),p=i(p,l,h,d,t[m+10],9,38016083),d=i(d,p,l,h,t[m+15],14,-660478335),h=i(h,d,p,l,t[m+4],20,-405537848),l=i(l,h,d,p,t[m+9],5,568446438),p=i(p,l,h,d,t[m+14],9,-1019803690),d=i(d,p,l,h,t[m+3],14,-187363961),h=i(h,d,p,l,t[m+8],20,1163531501),l=i(l,h,d,p,t[m+13],5,-1444681467),p=i(p,l,h,d,t[m+2],9,-51403784),d=i(d,p,l,h,t[m+7],14,1735328473),l=a(l,h=i(h,d,p,l,t[m+12],20,-1926607734),d,p,t[m+5],4,-378558),p=a(p,l,h,d,t[m+8],11,-2022574463),d=a(d,p,l,h,t[m+11],16,1839030562),h=a(h,d,p,l,t[m+14],23,-35309556),l=a(l,h,d,p,t[m+1],4,-1530992060),p=a(p,l,h,d,t[m+4],11,1272893353),d=a(d,p,l,h,t[m+7],16,-155497632),h=a(h,d,p,l,t[m+10],23,-1094730640),l=a(l,h,d,p,t[m+13],4,681279174),p=a(p,l,h,d,t[m],11,-358537222),d=a(d,p,l,h,t[m+3],16,-722521979),h=a(h,d,p,l,t[m+6],23,76029189),l=a(l,h,d,p,t[m+9],4,-640364487),p=a(p,l,h,d,t[m+12],11,-421815835),d=a(d,p,l,h,t[m+15],16,530742520),l=s(l,h=a(h,d,p,l,t[m+2],23,-995338651),d,p,t[m],6,-198630844),p=s(p,l,h,d,t[m+7],10,1126891415),d=s(d,p,l,h,t[m+14],15,-1416354905),h=s(h,d,p,l,t[m+5],21,-57434055),l=s(l,h,d,p,t[m+12],6,1700485571),p=s(p,l,h,d,t[m+3],10,-1894986606),d=s(d,p,l,h,t[m+10],15,-1051523),h=s(h,d,p,l,t[m+1],21,-2054922799),l=s(l,h,d,p,t[m+8],6,1873313359),p=s(p,l,h,d,t[m+15],10,-30611744),d=s(d,p,l,h,t[m+6],15,-1560198380),h=s(h,d,p,l,t[m+13],21,1309151649),l=s(l,h,d,p,t[m+4],6,-145523070),p=s(p,l,h,d,t[m+11],10,-1120210379),d=s(d,p,l,h,t[m+2],15,718787259),h=s(h,d,p,l,t[m+9],21,-343485551),l=r(l,n),h=r(h,u),d=r(d,c),p=r(p,f);return[l,h,d,p]}function c(t){for(var e="",r=32*t.length,n=0;n<r;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function f(t){var e=[];for(e[(t.length>>2)-1]=void 0,n=0;n<e.length;n+=1)e[n]=0;for(var r=8*t.length,n=0;n<r;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function l(t){for(var e,r="0123456789abcdef",n="",o=0;o<t.length;o+=1)e=t.charCodeAt(o),n+=r.charAt(e>>>4&15)+r.charAt(15&e);return n}function h(t){return unescape(encodeURIComponent(t))}function d(t){return c(u(f(e=h(t)),8*e.length));var e}function p(t,e){return function(t,e){var r,n,o=f(t),i=[],a=[];for(i[15]=a[15]=void 0,16<o.length&&(o=u(o,8*t.length)),r=0;r<16;r+=1)i[r]=909522486^o[r],a[r]=1549556828^o[r];return n=u(i.concat(f(e)),512+8*e.length),c(u(a.concat(n),640))}(h(t),h(e))}function m(t,e,r){return e?r?p(e,t):l(p(e,t)):r?d(t):l(d(t))}t.exports?t.exports=m:e.md5=m}(ot)})),at="INIT",st="WILL_MOUNT",ut="DID_MOUNT",ct="CHECK_SELF",ft="INSTALL_PLUGIN",lt="LISTENING",ht="COLLECTING",dt="SLEEP",pt={breadcrumbs:function(){return import("./BreadcrumbsPlugin-a1ed4add.js")},network:function(){return import("./NetworkCheckPlugin-bf920e7c.js")},redo:function(){return import("./RecordPlugin-d42c4457.js")},performance:function(){return import("./PerformancePlugin-fcf2bd30.js")}},mt="//webcdn.inke.cn/edith.cn",vt=mt.replace(/\/[^/]+$/,""),gt={breadcrumbs:{link:vt+"/plugins/BreadcrumbsPlugin.js",name:"BreadcrumbsPlugin"},network:{link:vt+"/plugins/NetworkCheckPlugin.js",name:"NetworkCheckPlugin"},redo:{link:vt+"/plugins/RecordPlugin.js",name:"RecordPlugin"},performance:{link:vt+"/plugins/PerformancePlugin.js",name:"PerformancePlugin"}},yt={ajaxWhiteList:[/p-center\.cn\/v1\/white-list\/get/,/op-center\.cn\/v1\/monitor/,/\/sockjs-node\/info/],resourceWhiteList:[].concat(Object.keys(gt).map((function(t){return gt[t].link})),["//webcdn.inke.cn/edith.cn/hm.gif"])};navigator.userAgent.match(/[^(\s]+(\s\([^)]+\))?/g);var wt=function(t,e){return function(){try{"function"!=typeof t&&(t=function(){});for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t.apply(this,n)}catch(t){console.warn("edith 内部报错",t),Tt("EdithError",t,e)}}},bt=function(t,e,r){var n=window.attachEvent;addEventListener?addEventListener(t,wt(e),r):n&&n("on"+t,wt(e))},Et=wt((function(t){var e={};for(var r in t){var n=t[r];e[r]=St(n)>6291456?"[large size Edith Plugins Data]":n}return e}));function St(t){return(t&&"object"==typeof t&&t instanceof Error?t.stack:t)||""}function kt(t){return t=nt(St(t))}var xt="";function Tt(t,e,r){r&&r.apiKey&&(xt=r.apiKey),It({version:"1.0.0",format:"es",name:t,message:kt(e),scriptUrl:mt,userAgent:navigator.userAgent,apiKey:xt})}var Ct=wt((function(t,e){localStorage.setItem(t,JSON.stringify(e))})),jt=wt((function(t){return JSON.parse(localStorage.getItem(t))}));function _t(t){var e=jt("_edith_key")||{},r=a(),n={apiKey:t.apiKey,errs:[],now:r,cookie:document.cookie,userAgent:navigator.userAgent};Object.keys(e).forEach((function(t){var o=e[t].length,i=e[t].filter((function(t){return r-t<72e5}));if(1!==i.length||1!==o){var a=i.slice(o===i.length?1:0);n.errs.push({onlyTag:t,times:a}),delete e[t]}})),0!==n.errs.length&&(Mt(n),Ct("_edith_key",e))}var Pt=null,Lt={root:"/",setRoot:function(t){this.root=t},getRootByUrl:function(t){return(t=t.replace(/^http(s?):\/\//,"//")).match(/^\/\//)?"":this.root},get:function(t){var e=this;return function(r){void 0===r&&(r={}),Pt=new XMLHttpRequest;var n=e.getRootByUrl(t);return function(t,e){return new Promise((function(r,n){t.onreadystatechange=wt((function(){if(4===t.readyState){var e=["","text"].indexOf(t.responseType)>=0?t.responseText:"no responseText";if(200===t.status){var o={};try{o=JSON.parse(e)}catch(t){o=e}r(o)}else t.status>399&&n(e)}})),e()}))}(Pt,(function(){Pt.open("GET",""+n+t+"?"+function(t,e){var r,n,o="";for(r in t)n=t[r],o+=r+"="+("function"==typeof e?e(n,r):n&&"object"==typeof n&&!Object.getPrototypeOf(n).slice?JSON.stringify(n):n)+"&";return o.slice(0,-1)}(r),!0),Pt.send()}))}},post:function(t){var e=this;return function(r){void 0===r&&(r={}),Pt=new XMLHttpRequest;var n=e.getRootByUrl(t);Pt.open("POST",""+n+t,!0),Pt.setRequestHeader("Content-type","application/json;charset=utf-8"),Pt.withCredentials=!0,Pt.send(JSON.stringify(r))}}};Lt.setRoot("https://event-edith.op-center.cn");var Nt=Lt.post("/v1/monitor/add"),Mt=Lt.post("/v1/monitor/batch-add"),At=Lt.get("/v1/upload/test-img"),Ot=Lt.get("/v1/white-list/get"),It=Lt.post("/v1/monitor/script-add"),Rt=["resourceWhiteList","ajaxWhiteList"],$t=function(t){if(2==+t.match_type){var e=t.match.match(/\/(\w)*$/);return new RegExp(t.match.slice(1,e.index),e[1])}return t.match},Ht=function(){function e(){var e=this;this.life="",this.plugins=[],this.state={plugins:{}},this.utils={compressData:kt,compressString:kt,measureBWSimple:At,edithAddEventListener:bt},this.init=function(r){if(e.life)return console.warn("只需要初始化一次");if(!e._waitPromise(r)){var n=r||{},o=n.apiKey,i=n.silentDev;if(!r||!o)return console.warn("请传入项目的apiKey");e.$life(at),e.setState({api_key:o}),i&&location.host.match(/^localhost|[\d.]+$/)&&(e.notListening=!0),e._willMount(r),e.initState=t({},e.state),e._didMount(e.state),e._checkSelf().then((function(){e.$life(ft),e._installPlugins(e).then((function(){e._collecting(),e.initState=t({},e.state)})),f(e.pluginInstalled)&&e.pluginInstalled(),e.$life(lt)})).catch(e._sleep.bind(e))}},this.setState=function(r,n){if(e.life!==ht||n){var o=e.state;e.state=t({},o,r)}},this.compilerCallback=function(r,n){var o,i=((o={})[r]=n,o);e.setState(gt[r]?i:{plugins:t({},e.state.plugins,i)},!0)},this.compiler=function(t,r){var n=e.compilerCallback,o=e;r(e,(function(e){n.call(o,t,e)}))},this.reportDebug=Nt}var r=e.prototype;return r.$life=function(t){this.life=t},r._waitPromise=function(t){var e=this;if(!window.Promise)return bt("promisePolyfill",(function(){return e.init(t)})),!0},r._willMount=function(t){var e=this,r=t.plugins;this.$life(st),f(this.willMount)&&this.willMount(t),this.plugins=r instanceof Array?r:[],Rt.forEach((function(t){e[t]=[].concat(e[t]||[],yt[t])}));Ot({apiKey:this.apiKey}).then((function(t){Rt.forEach((function(r,n){var o,i;e[r]=e[r].concat((o=t.data||[],i=n+1,o.filter((function(t){return+t.type===i})).map($t)))}))})).catch((function(t){}))},r._didMount=function(){this.$life(ut),f(this.didMount)&&this.didMount(),function t(e,r){!r&&_t(e);var n=setTimeout((function(){_t(e),clearTimeout(n),n=null,t(e,1)}),6e5)}(this)},r._checkSelf=function(){var t=this;return this.$life(ct),new Promise((function(e,r){if(f(t.checkSelf))try{t.checkSelf()}catch(t){console.log("edith自检发生错误",t),Tt("SelfCheckError",t),r(t)}e()}))},r._installPlugins=function(){var t=this;return new Promise((function(e,r){var n,o=[];t.plugins.forEach((function(t){if(t)if("string"==typeof t){var e=pt[t];e&&o.push(e())}else o.push(t)})),(n=o,Promise.all(n.map((function(t){return t.catch?t.catch((function(t){return 0})):t})))).then((function(r){(r=r.map((function(t){return f(t.default)?new t.default:t}))).forEach((function(e){e&&Rt.forEach((function(r){t[r]=[].concat(t[r],e[r]||[])}))})),t.plugins=r,e()}))}))},r._collecting=function(){var t=this;this.plugins.forEach((function(e){var r=e.constructor.name;if(!e.apply)return gt[e]||console.warn("Edith插件["+e.constructor.name+"]必须实现apply方法");try{e.apply(t.compiler.bind(t))}catch(e){Tt("CollectError",{error:St(e),plugin:r,life:t.life})}})),f(this.collecting)&&this.collecting()},r._sleep=function(){this.$life(dt),this.$life=function(){},f(this.sleep)&&this.sleep(),this.$handleCollect=function(){}},r.$handleCollect=function(){var e=this;if(this.life===lt){this.$life(ht);var r=setTimeout(wt((function(){var n,o,i,s=e.state,u=function(t){var e=t.message,r=t.name,n=t.extraInfo,o="resourceError"===r?p(e||""):e,i=location.host+location.pathname.replace(/index\.html$/,"")+r+o+p(n.url||"")+(n.method||"");return it(i)}(s);if(n=u,o=jt("_edith_key")||{},(i=!!o[n])?o[n].push(a()):o[n]=[a()],Ct("_edith_key",o),!i){var c={name:s.name,message:s.message,url:s.url,title:s.title,ajax:s.extraInfo||{url:""},target:s.target||{}};e.filters(c)&&"customError"!==s.type||(e._collecting(),e.reportDebug(t({},e.state,{onlyTag:u,plugins:kt(Et(e.state.plugins))})))}e.state=e.initState,e.$life(lt),clearTimeout(r),r=null})),16)}},e}();function Ut(){var e,r,n,o;!function(){if(f(t))return!1;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}t.prototype=Event.prototype,window.CustomEvent=t}(),e={abort:"ajaxAbort",error:"ajaxError",progress:"ajaxProgress",timeout:"ajaxTimeout",loadend:"ajaxLoadEnd"},r=window.XMLHttpRequest,n=["error","timeout","abort"],window.XMLHttpRequest=function(){var t=new r,o=!1;Object.keys(e).forEach((function(r){t.addEventListener(r,(function(t){c.call(this,e[r]),o||(o=n.indexOf(r)>=0),"loadend"===r&&(l(this.status)||o||c.call(this,e.error))}),!1)}));var i=t.send;t.send=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i.apply(t,r),t.body=r[0]};var s=t.open;return t.open=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];t.method=r[0],t.url=r[1],t.async=r[2],t.startTime=a(),c.call(t,"ajaxOpen"),s.apply(t,r)},t},(o=window.fetch)&&(window.fetch=function(e,r){var n={startTime:a(),status:0,body:null,statusText:"",_eid:s()};if(window.Request&&e instanceof window.Request){var i=e.url,u=e.method,f=e.body;n=t({},n,{url:i,method:u,body:f})}else n=t({url:e,method:"GET"},n,r);return c.call({options:n},"fetchStart"),o.apply(this,[e,r]).then((function(t){return t.options=n,l(t.status)||c.call({options:n},"fetchError"),c.call({options:n},"fetchEnd"),t}),(function(t){t.options=n,c.call({options:n},"fetchError")}))})}!function(){var t=this;window.Promise||function(t,e,r){void 0===r&&(r=function(){});var n=document.createElement("script");n.setAttribute("cdn-rendered",""),n.src=t,n.onload=e,n.onerror=r,document.getElementsByTagName("head")[0].appendChild(n)}("//webcdn.inke.cn/tpc/common/es6-promise/3.2.2/es6-promise.min.js",(function(){c.call(t,"promisePolyfill")}))}(),function(){var t=WebSocket;if(t){var e={open:"webSocketOpen",error:"webSocketError",close:"webSocketClose"};WebSocket=function(r,n){var o=new t(r,n);return o.startTime=a(),c.call(o,"webSocketStart"),Object.keys(e).forEach((function(t){o.addEventListener(t,(function(r){c.call(this,e[t])}),!1)})),o}}}();var Wt=new(function(r){var o,i;function s(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=r.call.apply(r,[this].concat(o))||this).silentDev=!1,e.silentPromise=!1,e.silentWebsocket=!1,e.silentResource=!1,e.silentHttp=!1,e.setHttpBody=!1,e.version="1.0.0",e.hE=function(r){if(r=e.errCb[r.type](r)){var n=y(r);e.life===lt&&(e.setState(t({},e.state,n)),e.$handleCollect())}},e.handlePromise=function(r,n){var o=e.utils.tryCatchFunc,i=setTimeout(o((function(){var n=r.reason;r.message="[object Error]"===Object.prototype.toString.call(n)?n.toString():St(n),r.name="unhandledrejection",r._type="error";var o=y(r);e.setState(t({},e.state,o)),clearTimeout(i),i=null,e.$handleCollect()})),500);window.onrejectionhandled=o((function(t,e){n===e&&(clearTimeout(i),i=null)}))},e.errCb={webSocketError:function(t){t.name=t._type="webSocketError";var r=t.detail.target||t.detail.currentTarget,n=r.url,o=r.startTime,i=r.openTime;if(!m(e.ajaxWhiteList,n))return t.extraInfo={url:n,elapsedTime:a()-(i||o)},t},resourceError:function(t){if(!e.silentResource){var r=t.target,n=g(r).toLowerCase(),o="";if(o="link"===n?r.href:r.src,!m(e.resourceWhiteList,o))return p(o)===p(location.href)&&(o=""),t.message=o,t.name=t._type="resourceError",t._target={tagName:n,className:r.className,id:r.id,outerHTML:e.utils.getSimpleString(r.outerHTML),xPath:h(r)},t}},ajaxError:function(t){t._type="httpError",t.name="ajaxError";var r=t.detail,n=r.target,o=r.time,i=n.method,a=n.url,s=n.startTime,u=n.responseText,c=n.statusText,f=n.status;if(!m(e.ajaxWhiteList,a))return t.extraInfo={elapsedTime:o-s,responseText:u,status:f,statusText:c,method:i,url:a},e.setHttpBody&&(t.extraInfo.body=n.body),t},fetchError:function(r){var n=r.detail,o=n.target.options,i=n.time;if(!m(e.ajaxWhiteList,o.url))return r._type="httpError",r.name=r.message="fetchError",r.error=r.detail,r.extraInfo=t({elapsedTime:i-o.startTime},o),e.setHttpBody||delete r.extraInfo.body,r},error:function(t){return t.target!==window?e.errCb.resourceError(t):t}},e}i=r,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,e(o,i);var c=s.prototype;return c.willMount=function(e){var r=this;for(var n in e)void 0===e[n]||f(this[n])||"version"===n||(this[n]=e[n]);var o=function(t){return wt(t,r)};this.utils=t({},this.utils,{getCurrentTime:a,getSimpleString:d,tryCatchFunc:o}),this.filters=e.filters&&o(e.filters)},c.didMount=function(){Ut()},c.checkSelf=function(){this.hE({type:"error",target:window}),this.silentResource||this.hE({type:"error",target:{src:"",tagName:"a",outerHTML:"",parentNode:document}}),this.silentHttp||this.hE({type:"ajaxError",detail:{target:{url:""}}}),this.silentHttp||this.hE({type:"fetchError",detail:{target:{options:{url:""}}}})},c.pluginInstalled=function(){this.notListening||(!function(){for(var t,e=n(document.getElementsByTagName("script"));!(t=e()).done;){var r=t.value,o=p(r.src||"");o&&"/"!==o[0]&&r.setAttribute("crossorigin","anonymous")}}(),bt("error",this.hE,!0),this.silentPromise||bt("unhandledrejection",this.handlePromise),this.silentHttp||(bt("ajaxError",this.hE),bt("ajaxTimeout",this.hE),bt("fetchError",this.hE)),this.silentWebsocket||bt("webSocketError",this.hE))},c.debug=function(e,r){this.setState(t({},this.state,y({name:St(e),message:St(r),timeStamp:u(),type:"customError"}))),this.$handleCollect()},c._changeReportUrl=function(t){t&&(this.ajaxWhiteList.push(t),this.reportDebug=Lt.post(t+""))},s}(Ht));export{Wt as E,t as _,u as a,h as b,s as c,m as d,c as e,g,v as i};
